# ガンプラ在庫監視Bot

プレミアムバンダイの商品在庫を自動で監視し、在庫が復活したらLINEで通知するシンプルなBotです。

### 主な機能

- **在庫の自動チェック**: 30分おきに在庫状況を自動で確認（ボタン判定による検出）。
- **LINEで通知**: 在庫復活を検知したら、登録ユーザー全員に商品URLをLINEでプッシュ通知。
- **CSV管理**: 監視対象商品と通知先ユーザーをCSVファイルで簡単に管理。

---

## 🚀 セットアップ

このBotは、GitHub Actionsの無料枠を使ってセットアップできます。

**詳細な手順はこちらのガイドをご覧ください:**

👉 **[セットアップガイド](./docs/SETUP.md)**

---

## 📚 ドキュメント

プロジェクトの詳細な情報は、以下のドキュメントをご覧ください：

- **[セットアップガイド](./docs/SETUP.md)** - 初期セットアップの手順
- **[仕様書](./docs/SPECIFICATION.md)** - プロジェクトの詳細な仕様とファイル構成
- **[テスト方法](./docs/TESTING.md)** - ローカルでのテスト方法と動作確認
- **[ユーザーIDの取得方法](./docs.md)** - LINE通知先のユーザーIDを取得する手順

---

## 🔧 高度な機能（オプション）

### ユーザーごとに通知を変えたい場合

現在の実装では、全友だちに同じ在庫復活通知を送信します。

しかし、**ユーザーごとに監視商品を変えたい**場合や**特定のユーザーにだけ通知したい**場合は、以下のリソースを参照してください：

#### ブランチ: `feature/user-specific-notifications`

ユーザーID管理機能の実装が保存されています。

```bash
# ブランチを確認
git checkout feature/user-specific-notifications

# ブランチの差分を確認
git diff main...feature/user-specific-notifications
```

#### examplesディレクトリ

```
examples/user-id-management/
├── README.md                 # 使い方ガイド
├── getUserId.js              # Webhookサーバー（ユーザーIDを手動取得）
├── csvHelper.ts              # CSV読み書きヘルパー
└── docs/
    ├── GET_USER_ID.md        # ユーザーID取得の詳細手順書
    └── ERROR.md              # トラブルシューティングガイド
```

詳細は [examples/user-id-management/README.md](./examples/user-id-management/README.md) を参照してください。

**参考資料**:
- [GitHub Issue #11](https://github.com/rin5uron/gunpla-stock-bot/issues/11) - 実装過程とエラー対応の記録（2025/12/7）

---

## アーキテクチャ

- **設定ファイル (CSV)**:
  - `config/targets.csv`: 監視対象商品の管理（ID、商品名、URL、最終在庫状態）
  - `config/users.csv`: LINE通知先ユーザーの管理（LINE ユーザーID、表示名）
- **在庫チェッカー (GitHub Actions)**:
  - 30分おきに起動し、Playwrightを使って商品ページのボタン判定により在庫を確認。
  - 在庫復活を検知したら、LINE Messaging APIで全ユーザーに商品URLを通知。
  - スクレイピング対策のため、カート投入などの自動操作は一切行わない。

---

## ⚠️ 注意

- このBotは、プレミアムバンダイの利用規約を遵守する範囲で、個人の購入補助を目的としています。商業目的での利用や、他者への迷惑となるような過度な利用は固く禁じます。
- 本Botは在庫復活を通知するのみで、**自動購入・自動カート投入は一切行いません**。ボタンのテキスト判定のみで在庫状態を検出します。
- スクレイピング対策およびアカウントBAN防止のため、カート投入などの自動操作機能は実装していません。通知を受け取ったら、手動で購入手続きを行ってください。
- 本プログラムの利用によって生じたいかなる損害についても、開発者は責任を負いません。自己責任でご利用ください。

---

## 📖 その他のリソース

- **[学習記録](./docs/study.md)** - プロジェクト開発中の学習内容とメモ
